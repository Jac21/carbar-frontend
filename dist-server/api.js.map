{"version":3,"sources":["../server/api.js"],"names":["router","express","Router","get","AppRoutes","path","action","post","req","res","body","email","password","temporaryCredentials","temporaryUsername","temporaryPassword","statusMessage","status","end","name","split","replace","now","Date","token","getTime","session","json","query","then","tasks","params","id","result","task","delete","undefined","module","exports"],"mappings":";;AAAA;;;;AACA;;AAKA;;AAGA;;;;AAIA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEAF,OAAOG,GAAP,CAAWC,kBAAU,CAAV,EAAaC,IAAxB,EAA8BD,kBAAU,CAAV,EAAaE,MAA3C;AACAN,OAAOG,GAAP,CAAWC,kBAAU,CAAV,EAAaC,IAAxB,EAA8BD,kBAAU,CAAV,EAAaE,MAA3C;AACAN,OAAOO,IAAP,CAAYH,kBAAU,CAAV,EAAaC,IAAzB,EAA+BD,kBAAU,CAAV,EAAaE,MAA5C;AACAN,OAAOG,GAAP,CAAWC,kBAAU,CAAV,EAAaC,IAAxB,EAA8BD,kBAAU,CAAV,EAAaE,MAA3C;AACAN,OAAOG,GAAP,CAAWC,kBAAU,CAAV,EAAaC,IAAxB,EAA8BD,kBAAU,CAAV,EAAaE,MAA3C;;AAEAN,OAAOO,IAAP,CAAY,WAAZ,EAAyB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,kBAIjCD,IAAIE,IAJ6B;AAAA,MAEnCC,KAFmC,aAEnCA,KAFmC;AAAA,MAGnCC,QAHmC,aAGnCA,QAHmC;;AAKrC,MAAI,CAACD,KAAD,IAAU,CAACC,QAAX,IAAuBD,UAAU,OAAjC,IAA4CA,UAC9CE,0BAAqBC,iBADnB,IACwCF,aAC1CC,0BAAqBE,iBAFvB,EAE0C;AACxCN,QAAIO,aAAJ,GAAoB,2BAApB;AACAP,QAAIQ,MAAJ,CAAW,GAAX,EAAgBC,GAAhB;AACD,GALD,MAKO;AACL,QAAMC,OAAOR,MAAMS,KAAN,CAAY,GAAZ,EAAiB,CAAjB,EAAoBC,OAApB,CAA4B,MAA5B,EAAoC,GAApC,CAAb,CADK,CACkD;AACvD,QAAMC,MAAM,IAAIC,IAAJ,EAAZ;AACA,QAAMC,mBAAiBF,IAAIG,OAAJ,EAAvB,CAHK,CAGmC;AACxC,QAAMC,UAAU;AACdf,kBADc;AAEdQ,gBAFc;AAGdK;AAHc,KAAhB;AAKA,0BAAWA,KAAX,EAAkBE,OAAlB;AACAjB,QAAIkB,IAAJ,CAASD,OAAT;AACD;AACF,CAtBD;;AAwBA1B,OAAOG,GAAP,CAAW,OAAX,EAAoB,UAACK,GAAD,EAAMC,GAAN,EAAc;AAChC,sBAASD,IAAIoB,KAAb,EAAoBC,IAApB,CAAyB;AAAA,WAASpB,IAAIkB,IAAJ,CAASG,KAAT,CAAT;AAAA,GAAzB;AACD,CAFD;;AAIA9B,OAAOG,GAAP,CAAW,WAAX,EAAwB,UAACK,GAAD,EAAMC,GAAN,EAAc;AACpC,qBAAQD,IAAIuB,MAAJ,CAAWC,EAAnB,EAAuBH,IAAvB,CAA4B,UAACI,MAAD,EAAY;AACtC,QAAI,CAACA,OAAOC,IAAZ,EAAkB;AAChBzB,UAAIQ,MAAJ,CAAW,GAAX,EAAgBC,GAAhB;AACD,KAFD,MAEO;AACLT,UAAIkB,IAAJ,CAASM,MAAT;AACD;AACF,GAND;AAOD,CARD;;AAUAjC,OAAOmC,MAAP,CAAc,aAAd,EAA6B,UAAC3B,GAAD,EAAMC,GAAN,EAAc;AACzCA,MAAIkB,IAAJ,CAASS,SAAT;AACD,CAFD;;AAIAC,OAAOC,OAAP,GAAiBtC,MAAjB","file":"api.js","sourcesContent":["import express from 'express';\r\nimport {\r\n  addSession,\r\n  getTasks,\r\n  getTask\r\n} from './data';\r\nimport {\r\n  temporaryCredentials\r\n} from './env';\r\nimport {\r\n  AppRoutes\r\n} from './src/routes';\r\n\r\nconst router = express.Router();\r\n\r\nrouter.get(AppRoutes[0].path, AppRoutes[0].action);\r\nrouter.get(AppRoutes[1].path, AppRoutes[1].action);\r\nrouter.post(AppRoutes[2].path, AppRoutes[2].action);\r\nrouter.get(AppRoutes[3].path, AppRoutes[3].action);\r\nrouter.get(AppRoutes[4].path, AppRoutes[4].action);\r\n\r\nrouter.post('/sessions', (req, res) => {\r\n  const {\r\n    email,\r\n    password\r\n  } = req.body;\r\n  if (!email || !password || email === 'error' || email !==\r\n    temporaryCredentials.temporaryUsername || password !==\r\n    temporaryCredentials.temporaryPassword) {\r\n    res.statusMessage = 'Invalid email or password';\r\n    res.status(401).end();\r\n  } else {\r\n    const name = email.split('@')[0].replace(/\\.|_/, ' '); // simulated\r\n    const now = new Date();\r\n    const token = `token-${now.getTime()}`; // simulated\r\n    const session = {\r\n      email,\r\n      name,\r\n      token\r\n    };\r\n    addSession(token, session);\r\n    res.json(session);\r\n  }\r\n});\r\n\r\nrouter.get('/task', (req, res) => {\r\n  getTasks(req.query).then(tasks => res.json(tasks));\r\n});\r\n\r\nrouter.get('/task/:id', (req, res) => {\r\n  getTask(req.params.id).then((result) => {\r\n    if (!result.task) {\r\n      res.status(404).end();\r\n    } else {\r\n      res.json(result);\r\n    }\r\n  });\r\n});\r\n\r\nrouter.delete('/sessions/*', (req, res) => {\r\n  res.json(undefined);\r\n});\r\n\r\nmodule.exports = router;\r\n"]}