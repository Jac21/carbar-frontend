{"version":3,"sources":["../../../server/src/controller/MapsController.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","sensitive_1","require","sensitive_2","MapsController","request","response","https","googleMapsApiEndpoint","destinations","origins","mode","language","key","googleMapsApiKey","units","googleMapsQuery","get","res","console","log","statusCode","body","on","chunk","mapsResponse","JSON","parse","timeToDestination","rows","elements","duration","text","numberOfMins","parseInt","split","client","accountSid","authToken","messages","create","from","to","message","sid","catch","error","err","send"],"mappings":"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","file":"MapsController.js","sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst sensitive_1 = require(\"../sensitive\");\r\nconst sensitive_2 = require(\"../sensitive\");\r\nfunction MapsController(request, response) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const https = require('https');\r\n        const googleMapsApiEndpoint = 'https://maps.googleapis.com/maps/api/distancematrix/json?';\r\n        const destinations = '&destinations=11800+Domain+Blvd+Austin+TX';\r\n        const origins = '&origins=11011+Domain+Drive+Austin+TX';\r\n        const mode = '&mode=walking';\r\n        const language = '&language=en-EN';\r\n        const key = '&key=' + sensitive_1.googleMapsApiKey;\r\n        const units = 'units=imperial';\r\n        const googleMapsQuery = googleMapsApiEndpoint + units + origins + destinations + mode + language + key;\r\n        https.get(googleMapsQuery, (res) => {\r\n            console.log('statusCode:', res.statusCode);\r\n            var body = '';\r\n            res.on('data', function (chunk) {\r\n                body += chunk;\r\n            });\r\n            res.on('end', function () {\r\n                var mapsResponse = JSON.parse(body);\r\n                console.log(\"Got a response: \", mapsResponse);\r\n                var timeToDestination = mapsResponse.rows[0].elements[0].duration.text;\r\n                var numberOfMins = parseInt(timeToDestination.split(' ')[0]);\r\n                console.log(numberOfMins);\r\n                if (numberOfMins < 15) {\r\n                    const client = require('twilio')(sensitive_2.accountSid, sensitive_2.authToken);\r\n                    client.messages\r\n                        .create({\r\n                        body: 'The Car Bar closest to you is at the HomeAway Office in the Domain. It is a 14 minute walk away from you!',\r\n                        from: '+15037147388',\r\n                        //Add media to a message \r\n                        //mediaUrl: 'https://raw.githubusercontent.com/Jac21/carbar-frontend/master/public/img/V1.png',\r\n                        to: +17348349568 //Customer's number\r\n                    })\r\n                        .then(message => console.log(message.sid))\r\n                        .catch(err => console.error(err));\r\n                    // console.log(user.PHONE_NUMBER);\r\n                }\r\n                console.log(\"Time to CarBar: \" + timeToDestination);\r\n                response.send(mapsResponse);\r\n            });\r\n        }).on('error', (e) => {\r\n            console.error(e);\r\n        });\r\n    });\r\n}\r\nexports.MapsController = MapsController;\r\n//# sourceMappingURL=MapsController.js.map"]}